### Ретроперспектива решения

##### Первый этап - пробы
Увидев задачу я сразу подумал, что нужно использовать YOLO, поскольку это по прежнему SOTA решения для задач детекции в большинстве доменов. Встала проблема - 30_000 неразмеченных изображений, большая часть из которых - негативные примеры. Изначально я решил сам собрать 100 изображений с яндекс и google картинок (причем фотографий типа фото из офиса, фото банкомата, скриншоты с видео из офиса Т Банка), быстро разметить, обучить 11n модель, предсказать с очень низким confidence часть датасета организаторов и посмотреть, какие положительные примеры они дали. Так прошло несколько итераций:
1. Я обучал модель
2. Делал предсказания по датасету пока не наберется 200 изображений с боксами с confidence < 0.4
3. Эти изображения добавлял в трейн датасет, если там были лого Т Банка - размечал, иначе просто добавлял как негативный пример (так по 80% негативных примеров получалось).
Так прошло несколько итераций, и вроде по результатам предсказаний модель работала неплохо (на метрики я не сильно смотрел, поскольку датасет был еще мал и валидационная выборка была для хоть какой то защиты от оверфиттинга).

Так я довел датасет до > 600 картинок

##### Второй этап - бесплатная разметка
До сих пор я занимался баловством без нормального анализа датасета, но для начала я решил кратно увеличить количество размеченных положительных примеров, для этого я пошел на Roboflow universe и начал искать датасеты с названием / классами t bank, т банк, tinkoff и тд, так я нашел 10 датасетов, отсмотрел их и лишь в двух увидел достойное качество разметки, множество негативных примеров и положительные примеры, отличающиеся от того что у меня есть в разметке. Я провалидировал эту разметку, поправил где надо, сделал новую версию датасета, закинул обучение и пошел заниматься более серьезным делом.

Так я довел датасет до > 1200 картинок

##### Третий этап - анализ датасета организаторов
Изначально предоставленный организаторами датасет вряд ли сильно полезен в исходном виде, поскольку там было очернь мало изображений с Т банком. Нужно было посмотреть на все группы изображений из этого датасета, так я и решил сделать, для этого необходимо было сделать кластеризацию.
В качестве эмбеддера использовал CLIP (ViT-B/32)
Далее через PCA сжал размерность до 50 осей
И с помощью HDBSCAN разделил на кластеры.
Получились идеально семантически разделенные кластера, несколько кластеров было с логотипом Т банка, я руками отобрал оттуда "хорошие" (более-менее сложные, не просто скриншот? где лого ортогонально камере) и относительно уникальные (не набирал 20 одинаковых картинок Т Банк бизнес), а с каждого кластера без Т Банка взял по 2 изображения в валидацию и 6 изображений для негативных примеров (помним что в датасете было уже более 600 негативных примеров). Визуально качество снова выросло.


##### Четвертый этап - Опять улучшаем датасет
Все еще в датасете было достаточно мало "сложных" реальных примеров, а не просто однообразных скриншотов, для этого я еще искал фотографии (ни в коем случае не скриншоты)
